<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoArt Deep Hierarchy Prototype</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Icons: Using simple Unicode/Text for speed/compatibility, but styled nicely -->

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #0f172a; height: 100vh; overflow: hidden; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 5px; height: 5px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Hierarchy Lines */
        .tree-line {
            position: absolute;
            left: 11px;
            top: 0;
            bottom: 0;
            width: 1px;
            background-color: #e2e8f0;
            z-index: 0;
        }

        /* Record Type Badges (Dynamic Styling) */
        .badge-project { @apply bg-blue-100 text-blue-800 border-blue-200; }
        .badge-process { @apply bg-purple-100 text-purple-800 border-purple-200; }
        .badge-stage { @apply bg-slate-100 text-slate-600 border-slate-200; }
        .badge-subprocess { @apply bg-orange-50 text-orange-700 border-orange-200; }
        
        /* Token Styling */
        .token {
            display: inline-flex;
            align-items: center;
            padding: 0 4px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        .token:hover { opacity: 0.8; }
        .token-project { background: #eff6ff; color: #1e40af; border-color: #dbeafe; }
        .token-sub { background: #fff7ed; color: #c2410c; border-color: #ffedd5; }
        
        /* Animation */
        .fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex flex-col h-full">

    <!-- HEADER: Global Context -->
    <header class="h-14 bg-white border-b border-slate-200 flex items-center justify-between px-4 shrink-0 z-20 shadow-sm">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-slate-900 rounded-lg flex items-center justify-center text-white font-bold">A</div>
            <div class="h-6 w-px bg-slate-200 mx-1"></div>
            <!-- Top Level Record: The Project -->
            <button onclick="inspectRecord('project')" class="flex items-center gap-2 hover:bg-slate-50 px-2 py-1 rounded transition-colors group">
                <span class="text-xs font-bold text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded border border-blue-100 uppercase tracking-wider">Project</span>
                <span class="font-semibold text-slate-700 group-hover:text-blue-700">Downtown Mural 2025</span>
            </button>
        </div>
        
        <!-- View Toggle -->
        <div class="flex bg-slate-100 p-0.5 rounded-lg">
            <button class="px-3 py-1 text-xs font-medium bg-white text-slate-800 rounded shadow-sm">Workflow</button>
            <button class="px-3 py-1 text-xs font-medium text-slate-500 hover:text-slate-700">Data Grid</button>
            <button class="px-3 py-1 text-xs font-medium text-slate-500 hover:text-slate-700">Calendar</button>
        </div>
    </header>

    <!-- WORKSPACE -->
    <div class="flex flex-1 overflow-hidden">

        <!-- 1. LEFT SIDEBAR: THE DEEP HIERARCHY -->
        <aside class="w-[280px] bg-slate-50 border-r border-slate-200 flex flex-col shrink-0">
            <!-- Process Selector (Level 2) -->
            <div class="p-3 border-b border-slate-200 bg-white">
                <label class="text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1 block">Current Process</label>
                <button onclick="inspectRecord('process')" class="w-full flex items-center justify-between bg-purple-50 hover:bg-purple-100 border border-purple-100 text-purple-900 px-3 py-2 rounded-lg transition-colors text-left group">
                    <div class="flex items-center gap-2">
                        <span>‚öôÔ∏è</span>
                        <span class="text-sm font-semibold">Standard Commission</span>
                    </div>
                    <span class="text-purple-400 text-xs group-hover:text-purple-600">Edit</span>
                </button>
            </div>
            
            <!-- The Tree (Stages -> Subprocesses) -->
            <div class="flex-1 overflow-y-auto p-2 custom-scroll">
                
                <!-- STAGE 1 (Folder) -->
                <div class="mb-1">
                    <button class="w-full flex items-center gap-2 px-2 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-100 rounded text-left">
                        <span class="text-slate-400 text-[10px]">‚ñº</span>
                        <span class="text-yellow-500">üìÇ</span> 
                        <span class="text-slate-800">1. Feasibility</span>
                    </button>
                    
                    <!-- Subprocesses inside Stage 1 -->
                    <div class="relative ml-2 pl-3 mt-1 space-y-1">
                        <div class="tree-line"></div>
                        
                        <!-- Subprocess Item (Active) -->
                        <div class="relative z-10">
                            <button onclick="selectSubprocess('site_survey')" class="w-full text-left px-2 py-2 text-xs font-medium bg-white border border-blue-200 shadow-sm rounded-md text-slate-800 flex items-center justify-between group">
                                <div class="flex items-center gap-2">
                                    <span class="w-1.5 h-1.5 rounded-full bg-orange-500"></span>
                                    Site Survey
                                </div>
                                <span class="text-[10px] bg-slate-100 text-slate-400 px-1 rounded opacity-0 group-hover:opacity-100">SUB</span>
                            </button>
                        </div>
                        
                        <!-- Subprocess Item -->
                        <div class="relative z-10">
                            <button onclick="selectSubprocess('budgeting')" class="w-full text-left px-2 py-2 text-xs font-medium text-slate-600 hover:bg-white hover:shadow-sm border border-transparent hover:border-slate-200 rounded-md transition-all flex items-center justify-between group">
                                <div class="flex items-center gap-2">
                                    <span class="w-1.5 h-1.5 rounded-full bg-slate-300"></span>
                                    Initial Budgeting
                                </div>
                                <span class="text-[10px] bg-slate-100 text-slate-400 px-1 rounded opacity-0 group-hover:opacity-100">SUB</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- STAGE 2 (Folder) -->
                <div class="mb-1 opacity-75">
                    <button class="w-full flex items-center gap-2 px-2 py-1.5 text-sm font-medium text-slate-700 hover:bg-slate-100 rounded text-left">
                        <span class="text-slate-400 text-[10px]">‚ñ∂</span>
                        <span class="text-yellow-500">üìÇ</span> 
                        <span class="text-slate-800">2. Design</span>
                    </button>
                </div>

                <!-- Create New Button -->
                <div class="pt-4 px-2">
                    <button class="w-full py-2 border border-dashed border-slate-300 rounded text-xs text-slate-500 hover:border-slate-400 hover:text-slate-700 transition-colors">
                        + New Stage or Subprocess
                    </button>
                </div>
            </div>
            
            <!-- Library -->
            <div class="p-3 border-t border-slate-200 bg-slate-50">
                <div class="text-[10px] font-bold text-slate-400 uppercase mb-2">Record Library</div>
                <div class="flex gap-2">
                    <div class="w-8 h-8 rounded bg-white border border-slate-200 flex items-center justify-center text-lg shadow-sm cursor-pointer hover:border-blue-300" title="Contacts">üë•</div>
                    <div class="w-8 h-8 rounded bg-white border border-slate-200 flex items-center justify-center text-lg shadow-sm cursor-pointer hover:border-blue-300" title="Artworks">üé®</div>
                    <div class="w-8 h-8 rounded bg-white border border-slate-200 flex items-center justify-center text-lg shadow-sm cursor-pointer hover:border-blue-300" title="Locations">üìç</div>
                </div>
            </div>
        </aside>


        <!-- 2. MIDDLE AREA: SUBPROCESS VIEW (Task List) -->
        <main class="flex-1 bg-white flex flex-col min-w-[400px] border-r border-slate-200 relative">
            
            <!-- Subprocess Header (It's a record too!) -->
            <div id="main-header" class="px-6 py-4 border-b border-slate-100 bg-white">
                <div class="flex justify-between items-start mb-2">
                    <div class="flex items-center gap-2">
                        <span class="px-1.5 py-0.5 rounded text-[10px] font-bold bg-orange-100 text-orange-700 border border-orange-200 uppercase">Subprocess Record</span>
                        <span class="text-xs text-slate-400">ID: SP-104</span>
                    </div>
                    <button onclick="inspectRecord('subprocess')" class="text-xs text-blue-600 hover:underline">Edit Fields</button>
                </div>
                <h1 class="text-2xl font-bold text-slate-800">Site Survey & Analysis</h1>
                <div class="flex gap-4 mt-2 text-xs text-slate-500">
                    <div class="flex items-center gap-1">
                        <span class="text-slate-400">Lead:</span>
                        <span class="bg-slate-100 px-1.5 py-0.5 rounded text-slate-700 font-medium">@SarahJ</span>
                    </div>
                    <div class="flex items-center gap-1">
                        <span class="text-slate-400">Due:</span>
                        <span class="bg-red-50 text-red-700 px-1.5 py-0.5 rounded font-medium">Oct 12</span>
                    </div>
                </div>
            </div>

            <!-- Task List -->
            <div class="flex-1 overflow-y-auto bg-slate-50 p-6 space-y-3 custom-scroll">
                
                <!-- Task 1 -->
                <div class="bg-white border border-slate-200 rounded-lg p-4 shadow-sm hover:border-blue-300 transition-all cursor-pointer group">
                    <div class="flex items-start gap-3">
                        <input type="checkbox" class="mt-1 w-4 h-4 text-blue-600 rounded border-slate-300">
                        <div class="flex-1">
                            <h3 class="text-sm font-semibold text-slate-800">Confirm Location Boundary</h3>
                            <p class="text-sm text-slate-600 mt-1 leading-relaxed">
                                Verify the GPS coordinates for <span class="token token-project" title="#project:name">#project:name</span> match the city filing.
                            </p>
                            <div class="mt-2 flex gap-2">
                                <span class="text-[10px] bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded">Engineering</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Task 2 -->
                <div class="bg-white border border-slate-200 rounded-lg p-4 shadow-sm hover:border-blue-300 transition-all cursor-pointer group ring-1 ring-blue-50">
                    <div class="flex items-start gap-3">
                        <input type="checkbox" class="mt-1 w-4 h-4 text-blue-600 rounded border-slate-300">
                        <div class="flex-1">
                            <h3 class="text-sm font-semibold text-slate-800">Submit Survey Report</h3>
                            <p class="text-sm text-slate-600 mt-1 leading-relaxed">
                                Upload the final PDF to <span class="token token-sub" title="#subprocess:folder_link">#subprocess:folder_link</span> before the deadline.
                            </p>
                        </div>
                    </div>
                </div>

                 <!-- Add Task -->
                 <button class="w-full py-2 border border-dashed border-slate-300 rounded text-sm text-slate-400 hover:bg-white hover:text-blue-600 hover:border-blue-300 transition-all">
                    + Add Task
                </button>

            </div>
        </main>


        <!-- 3. RIGHT PANEL: RECORD & SCHEMA INSPECTOR -->
        <aside id="inspector-panel" class="w-[380px] bg-white border-l border-slate-200 flex flex-col shrink-0 shadow-xl z-30 transition-all duration-300">
            
            <!-- Context Header -->
            <div class="h-14 border-b border-slate-100 flex items-center justify-between px-5 bg-slate-50/50">
                <span id="inspector-title" class="text-xs font-bold text-slate-500 uppercase tracking-wider">Record Inspector</span>
                <button onclick="toggleSchemaMode()" class="text-xs bg-white border border-slate-200 text-slate-600 px-2 py-1 rounded shadow-sm hover:text-blue-600 hover:border-blue-300 transition-colors">
                    üõ† Edit Schema
                </button>
            </div>

            <div class="flex-1 overflow-y-auto custom-scroll p-5" id="inspector-content">
                
                <!-- DEFAULT VIEW: Subprocess Record Details -->
                <div id="view-record" class="fade-in space-y-6">
                    
                    <!-- Identity Card -->
                    <div class="bg-orange-50 border border-orange-100 rounded-lg p-4">
                        <div class="text-[10px] text-orange-600 font-bold uppercase mb-1">Record Class: Subprocess</div>
                        <div class="text-lg font-bold text-slate-900">Site Survey & Analysis</div>
                        <div class="text-xs text-slate-500 mt-1 font-mono">UUID: 88a-99b-cc1</div>
                    </div>

                    <!-- Fields Section -->
                    <div class="space-y-4">
                        <h4 class="text-xs font-bold text-slate-400 uppercase border-b border-slate-100 pb-2">Record Fields</h4>
                        
                        <!-- Field 1 -->
                        <div>
                            <label class="block text-xs font-medium text-slate-500 mb-1">Status (Dropdown)</label>
                            <select class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500 bg-white">
                                <option>In Progress</option>
                                <option>Planned</option>
                                <option>Completed</option>
                            </select>
                        </div>

                        <!-- Field 2 -->
                        <div>
                            <label class="block text-xs font-medium text-slate-500 mb-1">Lead Surveyor (Contact Link)</label>
                            <div class="flex items-center gap-2 p-2 bg-slate-50 border border-slate-200 rounded-md">
                                <div class="w-5 h-5 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center text-[10px] font-bold">SJ</div>
                                <span class="text-sm text-slate-700">Sarah Jenkins</span>
                            </div>
                        </div>

                        <!-- Field 3 (Addressable Tag) -->
                        <div class="relative group">
                            <label class="block text-xs font-medium text-slate-500 mb-1">Folder Link (URL)</label>
                            <div class="flex">
                                <span class="inline-flex items-center px-2 rounded-l-md border border-r-0 border-slate-300 bg-slate-50 text-slate-500 text-xs font-mono">#subprocess:folder_link</span>
                                <input type="text" value="dropbox.com/proj/survey" class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-r-md text-sm border-slate-300 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <p class="text-[10px] text-slate-400 mt-1 hidden group-hover:block">This value is referenced in Task #2</p>
                        </div>
                    </div>

                </div>

                <!-- SCHEMA VIEW: Editing the Record Class -->
                <div id="view-schema" class="hidden fade-in space-y-6">
                    
                    <div class="bg-slate-800 text-slate-100 rounded-lg p-4 shadow-md">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="text-[10px] text-slate-400 font-bold uppercase mb-1">Editing Class Definition</div>
                                <div class="text-lg font-bold">Subprocess Record</div>
                            </div>
                            <button class="text-xs bg-slate-700 hover:bg-slate-600 px-2 py-1 rounded">Clone Type</button>
                        </div>
                        <p class="text-xs text-slate-400 mt-2 leading-relaxed">
                            Changes here affect all "Subprocess" records in this Project unless you fork this type.
                        </p>
                    </div>

                    <div class="space-y-3">
                        <h4 class="text-xs font-bold text-slate-400 uppercase border-b border-slate-100 pb-2">Defined Fields</h4>
                        
                        <!-- Schema Field Item -->
                        <div class="flex items-center justify-between p-2 bg-slate-50 border border-slate-200 rounded hover:bg-white hover:shadow-sm transition-all group">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-mono text-slate-400">text</span>
                                <span class="text-sm font-semibold text-slate-700">Title</span>
                            </div>
                            <span class="text-[10px] text-slate-400">System Required</span>
                        </div>

                        <!-- Schema Field Item -->
                        <div class="flex items-center justify-between p-2 bg-white border border-slate-200 rounded hover:shadow-sm transition-all group">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-mono text-blue-500">link</span>
                                <span class="text-sm font-semibold text-slate-700">Lead Surveyor</span>
                            </div>
                            <button class="text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity">√ó</button>
                        </div>

                        <!-- Schema Field Item -->
                        <div class="flex items-center justify-between p-2 bg-white border border-slate-200 rounded hover:shadow-sm transition-all group">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-mono text-green-500">url</span>
                                <span class="text-sm font-semibold text-slate-700">Folder Link</span>
                            </div>
                            <button class="text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity">√ó</button>
                        </div>

                        <!-- Add Field Button -->
                        <button class="w-full py-2 border border-dashed border-blue-300 bg-blue-50 text-blue-600 rounded text-xs font-medium hover:bg-blue-100 transition-colors">
                            + Add New Field Definition
                        </button>
                    </div>

                    <!-- Styling Override -->
                     <div class="space-y-3 pt-4 border-t border-slate-100">
                        <h4 class="text-xs font-bold text-slate-400 uppercase">Class Styling</h4>
                        <div class="flex items-center gap-3">
                            <div class="w-6 h-6 rounded bg-orange-500 cursor-pointer ring-2 ring-offset-1 ring-orange-500"></div>
                            <div class="w-6 h-6 rounded bg-blue-500 cursor-pointer opacity-30 hover:opacity-100"></div>
                            <div class="w-6 h-6 rounded bg-purple-500 cursor-pointer opacity-30 hover:opacity-100"></div>
                            <div class="w-6 h-6 rounded bg-green-500 cursor-pointer opacity-30 hover:opacity-100"></div>
                        </div>
                     </div>
                </div>

            </div>
        </aside>

    </div>

    <!-- SIMPLE JS LOGIC -->
    <script>
        // State
        let currentRecordType = 'subprocess';
        let isSchemaMode = false;

        // Content Data (Mock)
        const content = {
            project: {
                type: 'Project',
                title: 'Downtown Mural 2025',
                classColor: 'bg-blue-50 border-blue-100 text-blue-900',
                badge: 'Project Record',
                fields: [
                    { label: 'Client', value: 'City Council', type: 'text' },
                    { label: 'Budget', value: '$50,000', type: 'currency' },
                    { label: 'Location', value: '5th & Main', type: 'geo' }
                ]
            },
            process: {
                type: 'Process',
                title: 'Standard Commission',
                classColor: 'bg-purple-50 border-purple-100 text-purple-900',
                badge: 'Process Definition',
                fields: [
                    { label: 'Methodology', value: 'Public Call', type: 'select' },
                    { label: 'Timeline', value: '12 Weeks', type: 'text' }
                ]
            },
            subprocess: {
                type: 'Subprocess',
                title: 'Site Survey & Analysis',
                classColor: 'bg-orange-50 border-orange-100 text-orange-900',
                badge: 'Subprocess Record',
                fields: [
                    { label: 'Status', value: 'In Progress', type: 'select' },
                    { label: 'Lead', value: 'Sarah Jenkins', type: 'link' },
                    { label: 'Folder Link', value: 'dropbox.com/proj/survey', type: 'url' }
                ]
            }
        };

        function inspectRecord(type) {
            currentRecordType = type;
            const data = content[type];
            
            // If in schema mode, switch back to view mode first or update schema header
            const viewDiv = document.getElementById('view-record');
            const schemaDiv = document.getElementById('view-schema');
            
            // Update the "View Record" UI
            let fieldsHTML = '';
            data.fields.forEach(f => {
                fieldsHTML += `
                    <div>
                        <label class="block text-xs font-medium text-slate-500 mb-1">${f.label}</label>
                        <input type="text" value="${f.value}" class="w-full text-sm border-slate-300 rounded-md shadow-sm focus:border-blue-500 px-3 py-2 bg-white">
                    </div>
                `;
            });

            viewDiv.innerHTML = `
                <div class="${data.classColor} border rounded-lg p-4 transition-all">
                    <div class="text-[10px] opacity-75 font-bold uppercase mb-1">Record Class: ${data.type}</div>
                    <div class="text-lg font-bold text-slate-900">${data.title}</div>
                    <div class="text-xs opacity-50 mt-1 font-mono">UUID: ${Math.random().toString(36).substr(2, 6)}</div>
                </div>
                <div class="space-y-4">
                    <h4 class="text-xs font-bold text-slate-400 uppercase border-b border-slate-100 pb-2">Record Fields</h4>
                    ${fieldsHTML}
                </div>
            `;

            // Update Schema Header
            schemaDiv.querySelector('.text-lg').innerText = `${data.type} Record`;

            // Reset Mode
            if(isSchemaMode) toggleSchemaMode(); // Close schema if open, or just let it stay open but updated? Let's close for clarity.
            isSchemaMode = false;
            viewDiv.classList.remove('hidden');
            schemaDiv.classList.add('hidden');
        }

        function toggleSchemaMode() {
            isSchemaMode = !isSchemaMode;
            const viewDiv = document.getElementById('view-record');
            const schemaDiv = document.getElementById('view-schema');
            
            if (isSchemaMode) {
                viewDiv.classList.add('hidden');
                schemaDiv.classList.remove('hidden');
            } else {
                viewDiv.classList.remove('hidden');
                schemaDiv.classList.add('hidden');
            }
        }

        function selectSubprocess(id) {
            // Visual logic to handle selection state in sidebar
            // (In a real app, this would route the view)
            inspectRecord('subprocess');
        }
    </script>
</body>
</html>